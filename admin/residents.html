<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Residents - PG Management</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;700;800&amp;display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&amp;display=swap"
        rel="stylesheet" />
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#1193d4",
                        "background-light": "#f6f7f8",
                        "background-dark": "#000000",
                    },
                    fontFamily: {
                        "display": ["Manrope"],
                        "cursive": ["Dancing Script"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <style>
        body {
            min-height: max(884px, 100dvh);
        }
    </style>
</head>

<body class="bg-background-light dark:bg-background-dark font-display text-slate-800 dark:text-slate-200">
    <div class="relative flex min-h-screen w-full flex-col justify-between">
        <div class="flex-grow pb-20">
            <header
                class="sticky top-0 z-10 flex items-center justify-between border-b border-slate-200 dark:border-slate-800 bg-background-light/80 dark:bg-background-dark/80 p-4 backdrop-blur-sm">
                <div class="w-12"></div>
                <h1 class="text-3xl font-cursive font-bold text-slate-900 dark:text-white text-center flex-1">Residents
                </h1>
                <button id="darkModeToggle"
                    class="flex h-12 w-12 cursor-pointer items-center justify-center rounded-full text-slate-600 dark:text-slate-300 hover:bg-primary/10 dark:hover:bg-primary/20 focus:outline-none">
                    <svg class="h-6 w-6 dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z">
                        </path>
                    </svg>
                    <svg class="h-6 w-6 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 3v1m0 16v1m8.66-8.66l-.707.707M4.04 4.04l-.707.707M21 12h-1M4 12H3m15.96-4.04l-.707-.707M6.75 17.25l-.707-.707M12 6a6 6 0 100 12 6 6 0 000-12z">
                        </path>
                    </svg>
                </button>
            </header>
            <main class="p-4 space-y-6">
                <div class="relative">
                    <input type="search" placeholder="Search residents..."
                        class="w-full h-12 px-4 pl-10 rounded-lg bg-slate-100 dark:bg-slate-800/50 border-transparent focus:ring-2 focus:ring-primary focus:border-transparent" />
                    <svg class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"
                        xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 256 256"
                        fill="currentColor">
                        <path
                            d="M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z">
                        </path>
                    </svg>
                </div>
                <div id="resident-list-container" class="space-y-6">
                    <section data-property-group="Property A">
                        <h2 class="text-lg font-bold text-slate-900 dark:text-white mb-2">Property A</h2>
                        <div class="space-y-2">
                            <div class="resident-item cursor-pointer flex items-center gap-4 rounded-lg p-3 hover:bg-slate-100 dark:hover:bg-slate-800/50 bg-red-500/5 dark:bg-red-500/10"
                                data-name="John Doe" data-property="Property A" data-room="101"
                                data-phone="+91 98765 43210"
                                data-avatar="https://i.pravatar.cc/150?u=a042581f4e29026704d" data-rent-status="overdue"
                                data-rent-amount="12500" data-sharing="2 Sharing">
                                <img class="resident-avatar size-12 rounded-full object-cover"
                                    src="https://i.pravatar.cc/150?u=a042581f4e29026704d" alt="John Doe">
                                <div class="flex-grow">
                                    <p class="font-semibold text-slate-800 dark:text-slate-100 resident-name">John Doe
                                    </p>
                                    <p class="text-sm text-slate-500 dark:text-slate-400 resident-info">Room 101
                                        <span
                                            class="ml-2 inline-block px-2 py-0.5 text-xs font-semibold text-red-700 bg-red-100 dark:text-red-200 dark:bg-red-500/30 rounded-full">Rent
                                            Overdue</span>
                                    </p>
                                </div>
                                <div class="text-right shrink-0">
                                    <p class="font-bold text-lg text-red-500">₹12,500</p>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section data-property-group="Property B">
                        <h2 class="text-lg font-bold text-slate-900 dark:text-white mb-2">Property B</h2>
                        <div class="space-y-2">
                            <div class="resident-item cursor-pointer flex items-center gap-4 rounded-lg p-3 hover:bg-slate-100 dark:hover:bg-slate-800/50"
                                data-name="Jane Smith" data-property="Property B" data-room="205"
                                data-phone="+91 98765 12345"
                                data-avatar="https://i.pravatar.cc/150?u=a042581f4e29026705d" data-rent-status="paid"
                                data-rent-amount="12500" data-sharing="3 Sharing">
                                <img class="resident-avatar size-12 rounded-full object-cover"
                                    src="https://i.pravatar.cc/150?u=a042581f4e29026705d" alt="Jane Smith">
                                <div class="flex-grow">
                                    <p class="font-semibold text-slate-800 dark:text-slate-100 resident-name">Jane Smith
                                    </p>
                                    <p class="text-sm text-slate-500 dark:text-slate-400 resident-info">Room 205 (3
                                        Sharing)</p>
                                </div>
                                <div class="text-right shrink-0">
                                    <p class="font-bold text-lg text-slate-800 dark:text-slate-200">₹12,500</p>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </main>
        </div>
        <nav
            class="sticky bottom-0 z-10 border-t border-slate-200 dark:border-slate-800 bg-background-light/80 dark:bg-background-dark/80 backdrop-blur-sm">
            <div class="flex justify-around p-2">
                <a class="flex flex-1 flex-col items-center justify-center gap-1 rounded-full p-2 text-slate-500 dark:text-slate-400 hover:text-primary"
                    href="./dashshboad.html">
                    <div class="p-2">
                        <svg fill="currentColor" height="24" viewBox="0 0 256 256" width="24"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M224,115.55V208a16,16,0,0,1-16,16H168a16,16,0,0,1-16-16V168a8,8,0,0,0-8-8H112a8,8,0,0,0-8,8v40a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V115.55a16,16,0,0,1,5.17-11.78l80-75.48.11-.11a16,16,0,0,1,21.53,0,1.14,1.14,0,0,0,.11.11l80,75.48A16,16,0,0,1,224,115.55Z">
                            </path>
                        </svg>
                    </div>
                    <p class="text-xs font-medium">Home</p>
                </a>
                <a class="flex flex-1 flex-col items-center justify-center gap-1 rounded-full p-2 text-slate-500 dark:text-slate-400 hover:text-primary"
                    href="./properties.html">
                    <div class="p-2">
                        <svg fill="currentColor" height="24" viewBox="0 0 256 256" width="24"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M240,208H224V96a16,16,0,0,0-16-16H144V32a16,16,0,0,0-24.88-13.32L39.12,72A16,16,0,0,0,32,85.34V208H16a8,8,0,0,0,0,16H240a8,8,0,0,0,0-16ZM208,96V208H144V96ZM48,85.34,128,32V208H48ZM112,112v16a8,8,0,0,1-16,0V112a8,8,0,1,1,16,0Zm-32,0v16a8,8,0,0,1-16,0V112a8,8,0,1,1,16,0Zm0,56v16a8,8,0,0,1-16,0V168a8,8,0,0,1,16,0Zm32,0v16a8,8,0,0,1-16,0V168a8,8,0,0,1,16,0Z">
                            </path>
                        </svg>
                    </div>
                    <p class="text-xs font-medium">Properties</p>
                </a>
                <a class="flex flex-1 flex-col items-center justify-center gap-1 rounded-full p-2 text-primary"
                    href="./residents.html">
                    <div class="bg-primary/10 dark:bg-primary/20 rounded-full p-2">
                        <svg fill="currentColor" height="24" viewBox="0 0 256 256" width="24"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M117.25,157.92a60,60,0,1,0-66.5,0A95.83,95.83,0,0,0,3.53,195.63a8,8,0,1,0,13.4,8.74,80,80,0,0,1,134.14,0,8,8,0,0,0,13.4-8.74A95.83,95.83,0,0,0,117.25,157.92ZM40,108a44,44,0,1,1,44,44A44.05,44.05,0,0,1,40,108Zm210.14,98.7a8,8,0,0,1-11.07-2.33A79.83,79.83,0,0,0,172,168a8,8,0,0,1,0-16,44,44,0,1,0-16.34-84.87,8,8,0,1,1-5.94-14.85,60,60,0,0,1,55.53,105.64,95.83,95.83,0,0,1,47.22,37.71A8,8,0,0,1,250.14,206.7Z">
                            </path>
                        </svg>
                    </div>
                    <p class="text-xs font-bold">Residents</p>
                </a>
                <a class="flex flex-1 flex-col items-center justify-center gap-1 rounded-full p-2 text-slate-500 dark:text-slate-400 hover:text-primary"
                    href="./complaints.html">
                    <div class="p-2">
                        <svg fill="currentColor" height="24" viewBox="0 0 256 256" width="24"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M240,120a48.05,48.05,0,0,0-48-48H152.2c-2.91-.17-53.62-3.74-101.91-44.24A16,16,0,0,0,24,40V200a16,16,0,0,0,26.29,12.25c37.77-31.68,77-40.76,93.71-43.3v31.72A16,16,0,0,0,151.12,214l11,7.33A16,16,0,0,0,186.5,212l11.77-44.36A48.07,48.07,0,0,0,240,120ZM40,199.93V40h0c42.81,35.91,86.63,45,104,47.24v65.48C126.65,155,82.84,164.07,40,199.93Zm131,8,0,.11-11-7.33V168h21.6ZM192,152H160V88h32a32,32,0,1,1,0,64Z">
                            </path>
                        </svg>
                    </div>
                    <p class="text-xs font-medium">Complaints</p>
                </a>
                <a class="flex flex-1 flex-col items-center justify-center gap-1 rounded-full p-2 text-slate-500 dark:text-slate-400 hover:text-primary"
                    href="./settings.html">
                    <div class="p-2">
                        <svg fill="currentColor" height="24" viewBox="0 0 256 256" width="24"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M128,80a48,48,0,1,0,48,48A48.05,48.05,0,0,0,128,80Zm0,80a32,32,0,1,1,32-32A32,32,0,0,1,128,160Zm88-29.84q.06-2.16,0-4.32l14.92-18.64a8,8,0,0,0,1.48-7.06,107.21,107.21,0,0,0-10.88-26.25,8,8,0,0,0-6-3.93l-23.72-2.64q-1.48-1.56-3-3L186,40.54a8,8,0,0,0-3.94-6,107.71,107.71,0,0,0-26.25-10.87,8,8,0,0,0-7.06,1.49L130.16,40Q128,40,125.84,40L107.2,25.11a8,8,0,0,0-7.06-1.48A107.6,107.6,0,0,0,73.89,34.51a8,8,0,0,0-3.93,6L67.32,64.27q-1.56,1.49-3,3L40.54,70a8,8,0,0,0-6,3.94,107.71,107.71,0,0,0-10.87,26.25,8,8,0,0,0,1.49,7.06L40,125.84Q40,128,40,130.16L25.11,148.8a8,8,0,0,0-1.48,7.06,107.21,107.21,0,0,0,10.88,26.25,8,8,0,0,0,6,3.93l23.72,2.64q1.49,1.56,3,3L70,215.46a8,8,0,0,0,3.94,6,107.71,107.71,0,0,0,26.25,10.87,8,8,0,0,0,7.06-1.49L125.84,216q2.16.06,4.32,0l18.64,14.92a8,8,0,0,0,7.06,1.48,107.21,107.21,0,0,0,26.25-10.88,8,8,0,0,0,3.93-6l2.64-23.72q1.56-1.48,3-3L215.46,186a8,8,0,0,0,6-3.94,107.71,107.71,0,0,0,10.87-26.25,8,8,0,0,0-1.49-7.06Zm-16.1-6.5a73.93,73.93,0,0,1,0,8.68,8,8,0,0,0,1.74,5.48l14.19,17.73a91.57,91.57,0,0,1-6.23,15L187,173.11a8,8,0,0,0-5.1,2.64,74.11,74.11,0,0,1-6.14,6.14,8,8,0,0,0-2.64,5.1l-2.51,22.58a91.32,91.32,0,0,1-15,6.23l-17.74-14.19a8,8,0,0,0-5-1.75h-.48a73.93,73.93,0,0,1-8.68,0,8,8,0,0,0-5.48,1.74L100.45,215.8a91.57,91.57,0,0,1-15-6.23L82.89,187a8,8,0,0,0-2.64-5.1,74.11,74.11,0,0,1-6.14-6.14,8,8,0,0,0-5.1-2.64L46.43,170.6a91.32,91.32,0,0,1-6.23-15l14.19-17.74a8,8,0,0,0,1.74-5.48,73.93,73.93,0,0,1,0-8.68,8,8,0,0,0-1.74-5.48L40.2,100.45a91.57,91.57,0,0,1,6.23-15L69,82.89a8,8,0,0,0,5.1-2.64,74.11,74.11,0,0,1,6.14-6.14A8,8,0,0,0,82.89,69L85.4,46.43a91.32,91.32,0,0,1,15-6.23l17.74,14.19a8,8,0,0,0,5.48,1.74,73.93,73.93,0,0,1,8.68,0,8,8,0,0,0,5.48-1.74L155.55,40.2a91.57,91.57,0,0,1,15,6.23L173.11,69a8,8,0,0,0,2.64,5.1,74.11,74.11,0,0,1,6.14,6.14,8,8,0,0,0,5.1,2.64l22.58,2.51a91.32,91.32,0,0,1,6.23,15l-14.19,17.74A8,8,0,0,0,199.87,123.66Z">
                            </path>
                        </svg>
                    </div>
                    <p class="text-xs font-medium">Settings</p>
                </a>
            </div>
        </nav>
    </div>

    <!-- Add/Edit Resident Modal -->
    <div id="residentFormModal"
        class="fixed inset-0 z-50 hidden items-center justify-center bg-black/60 backdrop-blur-sm p-4">
        <div class="bg-background-light dark:bg-slate-900 rounded-2xl shadow-2xl w-full max-w-md">
            <div class="flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-800">
                <h3 id="modalTitle" class="text-lg font-bold text-slate-900 dark:text-white">Add New Resident</h3>
                <button id="closeFormModalBtn" class="text-slate-500 dark:text-slate-400 hover:text-primary">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 256 256"
                        fill="currentColor">
                        <path
                            d="M208.49,191.51a12,12,0,0,1-17,17L128,145,64.49,208.49a12,12,0,0,1-17-17L111,128,47.51,64.49a12,12,0,0,1,17-17L128,111l63.51-63.52a12,12,0,0,1,17,17L145,128Z">
                        </path>
                    </svg>
                </button>
            </div>
            <form id="residentForm" class="p-6 space-y-4">
                <div>
                    <label for="residentName"
                        class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Full Name</label>
                    <input type="text" id="residentName" required
                        class="form-input w-full rounded-lg border-0 bg-slate-100 dark:bg-slate-800/50 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-primary h-12 px-4">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="col-span-2 sm:col-span-1">
                        <label for="residentProperty"
                            class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Property</label>
                        <input type="text" id="residentProperty" required
                            class="form-input w-full rounded-lg border-0 bg-slate-100 dark:bg-slate-800/50 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-primary h-12 px-4">
                    </div>
                    <div class="col-span-2 sm:col-span-1 grid grid-cols-2 gap-4">
                        <div>
                            <label for="residentRoom"
                                class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Room
                                No.</label>
                            <input type="text" id="residentRoom" required
                                class="form-input w-full rounded-lg border-0 bg-slate-100 dark:bg-slate-800/50 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-primary h-12 px-4">
                        </div>
                        <div>
                            <label for="residentSharing"
                                class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Sharing</label>
                            <input type="text" id="residentSharing" required
                                class="form-input w-full rounded-lg border-0 bg-slate-100 dark:bg-slate-800/50 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-primary h-12 px-4"
                                placeholder="e.g. 2">
                        </div>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label for="residentPhone"
                            class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Phone</label>
                        <input type="tel" id="residentPhone" required
                            class="form-input w-full rounded-lg border-0 bg-slate-100 dark:bg-slate-800/50 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-primary h-12 px-4">
                    </div>
                </div>
                <div>
                    <label for="residentAvatar"
                        class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">Avatar Image
                        URL</label>
                    <input type="url" id="residentAvatar" required
                        class="form-input w-full rounded-lg border-0 bg-slate-100 dark:bg-slate-800/50 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-primary h-12 px-4"
                        placeholder="Enter image URL or upload">
                    <div class="mt-2 text-sm">
                        <label for="residentAvatarFile" class="cursor-pointer text-primary hover:underline">Upload from
                            gallery</label>
                        <input type="file" id="residentAvatarFile" accept="image/*" class="hidden">
                        <span class="text-slate-400 dark:text-slate-500 mx-1">or</span>
                        <label for="residentAvatarCamera" class="cursor-pointer text-primary hover:underline">Take a
                            photo</label>
                        <input type="file" id="residentAvatarCamera" accept="image/*" capture="environment"
                            class="hidden">
                    </div>
                </div>
                <div class="flex items-center justify-end pt-4 gap-3">
                    <button type="button" id="deleteResidentBtn"
                        class="w-full sm:w-auto bg-red-100 dark:bg-red-500/20 text-red-600 dark:text-red-400 font-bold py-3 px-6 rounded-lg hover:bg-red-200 dark:hover:bg-red-500/30 transition duration-300 hidden">
                        Delete
                    </button>
                    <button type="submit"
                        class="w-full bg-primary text-white font-bold py-3 px-6 rounded-lg shadow-lg shadow-primary/30 hover:bg-opacity-90 transition duration-300">
                        Save Resident
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Resident FAB -->
    <button id="addResidentBtn"
        class="fixed bottom-24 right-6 bg-primary text-white rounded-full p-4 shadow-lg hover:bg-primary/90 transition-transform hover:scale-105">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 256 256" fill="currentColor">
            <path
                d="M224,128a8,8,0,0,1-8,8H136v80a8,8,0,0,1-16,0V136H40a8,8,0,0,1,0-16h80V40a8,8,0,0,1,16,0v80h80A8,8,0,0,1,224,128Z">
            </path>
        </svg>
    </button>

    <script>
        const darkModeToggle = document.getElementById('darkModeToggle');
        const htmlEl = document.documentElement;

        const applyTheme = (theme) => {
            if (theme === 'dark') {
                htmlEl.classList.add('dark');
            } else {
                htmlEl.classList.remove('dark');
            }
        };

        const savedTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        applyTheme(savedTheme);

        darkModeToggle.addEventListener('click', () => {
            const newTheme = htmlEl.classList.contains('dark') ? 'light' : 'dark';
            localStorage.setItem('theme', newTheme);
            applyTheme(newTheme);
        });

        // Add/Edit Resident Modal Logic
        const residentFormModal = document.getElementById('residentFormModal');
        const closeFormModalBtn = document.getElementById('closeFormModalBtn');
        const addResidentBtn = document.getElementById('addResidentBtn');
        const residentForm = document.getElementById('residentForm');
        const modalTitle = document.getElementById('modalTitle');
        const residentAvatarFileInput = document.getElementById('residentAvatarFile');
        const deleteResidentBtn = document.getElementById('deleteResidentBtn');
        const residentAvatarCameraInput = document.getElementById('residentAvatarCamera');
        const residentListContainer = document.getElementById('resident-list-container');
        let editingItem = null;

        const openModalForNew = () => {
            editingItem = null;
            modalTitle.textContent = 'Add New Resident';
            residentForm.reset();
            residentAvatarCameraInput.value = '';
            residentAvatarFileInput.value = '';
            deleteResidentBtn.classList.add('hidden');
            residentFormModal.classList.remove('hidden');
            residentFormModal.classList.add('flex');
        };

        const openModalForEdit = (item) => {
            editingItem = item;
            modalTitle.textContent = 'Edit Resident';
            residentForm.residentName.value = item.dataset.name;
            residentForm.residentProperty.value = item.dataset.property;
            residentForm.residentRoom.value = item.dataset.room;
            residentForm.residentPhone.value = item.dataset.phone;
            residentForm.residentSharing.value = item.dataset.sharing.split(' ')[0];
            residentForm.residentAvatar.value = item.dataset.avatar;
            residentAvatarCameraInput.value = '';
            residentAvatarFileInput.value = '';
            deleteResidentBtn.classList.remove('hidden');
            residentFormModal.classList.remove('hidden');
            residentFormModal.classList.add('flex');
        };

        const closeModal = () => {
            residentFormModal.classList.add('hidden');
            residentFormModal.classList.remove('flex');
        };

        addResidentBtn.addEventListener('click', openModalForNew);
        closeFormModalBtn.addEventListener('click', closeModal);
        residentFormModal.addEventListener('click', (e) => {
            if (e.target === residentFormModal) closeModal();
        });

        deleteResidentBtn.addEventListener('click', () => {
            if (editingItem && confirm('Are you sure you want to delete this resident?')) {
                editingItem.remove();
                // Optional: if the property group is now empty, remove it too.
                // const parentGroup = editingItem.closest('section');
                closeModal();
            }
        });

        document.querySelectorAll('.resident-item').forEach(item => {
            item.addEventListener('click', () => openModalForEdit(item));
        });

        const handleFileSelect = (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    residentForm.residentAvatar.value = event.target.result;
                };
                reader.readAsDataURL(file);
            }
        };

        residentAvatarFileInput.addEventListener('change', handleFileSelect);
        residentAvatarCameraInput.addEventListener('change', handleFileSelect);

        residentForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const name = residentForm.residentName.value;
            const property = residentForm.residentProperty.value;
            const room = residentForm.residentRoom.value;
            const phone = residentForm.residentPhone.value;
            const sharing = residentForm.residentSharing.value;
            const avatar = residentForm.residentAvatar.value;
            const sharingText = `${sharing} Sharing`;

            if (editingItem) {
                editingItem.dataset.name = name;
                editingItem.dataset.property = property;
                editingItem.dataset.room = room;
                editingItem.dataset.phone = phone;
                editingItem.dataset.sharing = sharingText;
                editingItem.dataset.avatar = avatar;
                editingItem.querySelector('.resident-name').textContent = name;
                editingItem.querySelector('.resident-info').textContent = `Room ${room} (${sharingText})`;
                editingItem.querySelector('.resident-avatar').src = avatar;
                // Note: Logic to move item to a different property group if property name changes is not implemented.
                // Note: Logic to update rent status is not implemented.
            } else {
                let propertyGroup = residentListContainer.querySelector(`[data-property-group="${property}"]`);
                if (!propertyGroup) {
                    const newGroupHTML = `
                        <section data-property-group="${property}">
                            <h2 class="text-lg font-bold text-slate-900 dark:text-white mb-2">${property}</h2>
                            <div class="space-y-2"></div>
                        </section>
                    `;
                    const newGroup = document.createElement('div');
                    newGroup.innerHTML = newGroupHTML.trim();
                    propertyGroup = newGroup.firstChild;
                    residentListContainer.appendChild(propertyGroup);
                }

                const residentList = propertyGroup.querySelector('.space-y-2');
                const newItemHTML = `
                    <div class="resident-item cursor-pointer flex items-center gap-4 rounded-lg p-3 hover:bg-slate-100 dark:hover:bg-slate-800/50" data-name="${name}" data-property="${property}" data-room="${room}" data-phone="${phone}" data-avatar="${avatar}" data-rent-status="paid" data-sharing="${sharingText}">
                        <img class="resident-avatar size-12 rounded-full object-cover" src="${avatar}" alt="${name}">
                        <div class="flex-grow">
                            <p class="font-semibold text-slate-800 dark:text-slate-100 resident-name">${name}</p>
                            <p class="text-sm text-slate-500 dark:text-slate-400 resident-info">Room ${room} (${sharingText})</p>
                        </div>
                        <svg class="text-slate-400" fill="currentColor" height="16" viewBox="0 0 256 256" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M181.66,133.66l-80,80A8,8,0,0,1,88,208V48a8,8,0,0,1,13.66-5.66l80,80A8,8,0,0,1,181.66,133.66Z" transform="rotate(-90 128 128)"></path></svg>
                    </div>
                `;
                const newItem = document.createElement('div');
                newItem.innerHTML = newItemHTML.trim();
                const newItemElement = newItem.firstChild;
                residentList.appendChild(newItemElement);
                newItemElement.addEventListener('click', () => openModalForEdit(newItemElement));
            }

            closeModal();
        });
    </script>
</body>

</html>